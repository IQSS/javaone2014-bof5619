<!DOCTYPE html>
<html>
  <head>
    <title>BOF5619 Lean Beans (are made of this): Command pattern vs. MVC</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <style type="text/css">
      @import url(http://fonts.googleapis.com/css?family=Yanone+Kaffeesatz);
      @import url(http://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic);
      @import url(http://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic);

      body { font-family: 'Droid Serif'; }
      h1, h2, h3 {
        font-family: 'Yanone Kaffeesatz';
        font-weight: normal;
      }
      .remark-code, .remark-inline-code { font-family: 'Ubuntu Mono'; }
      /* Two-column layout */
      .left-column {
        color: #777;
        width: 20%;
        height: 92%;
        float: left;
      }
        .left-column h2:last-of-type, .left-column h3:last-child {
          color: #000;
        }
      .right-column {
        width: 75%;
        float: right;
        padding-top: 1em;
      }
      .bigfont {
        font-size: 2em;
      }

      /* from http://nicolasgallagher.com/pure-css-speech-bubbles/demo/ */
      .example-obtuse {
        position:relative;
        padding:15px 30px;
        margin:0;
        color:#000;
        background:#f3961c; /* default background for browsers without gradient support */
        /* css3 */
        background:-webkit-gradient(linear, 0 0, 0 100%, from(#f9d835), to(#f3961c));
        background:-moz-linear-gradient(#f9d835, #f3961c);
        background:-o-linear-gradient(#f9d835, #f3961c);
        background:linear-gradient(#f9d835, #f3961c);
        /* Using longhand to avoid inconsistencies between Safari 4 and Chrome 4 */
        -webkit-border-top-left-radius:25px 50px;
        -webkit-border-top-right-radius:25px 50px;
        -webkit-border-bottom-right-radius:25px 50px;
        -webkit-border-bottom-left-radius:25px 50px;
        -moz-border-radius:25px / 50px;
        border-radius:25px / 50px;
      }

      /* display of quote author (alternatively use a class on the element following the blockquote) */
      .example-obtuse + p {margin:10px 150px 2em 0; text-align:right; font-style:italic;}

      /* creates the larger triangle */
      .example-obtuse:before {
        content:"";
        position:absolute;
        bottom:-30px;
        right:80px;
        border-width:0 0 30px 50px;
        border-style:solid;
        border-color:transparent #f3961c;
        /* reduce the damage in FF3.0 */
        display:block;
        width:0;
      }

      /* creates the smaller triangle */
      .example-obtuse:after {
        content:"";
        position:absolute;
        bottom:-30px;
        right:110px;
        border-width:0 0 30px 20px;
        border-style:solid;
        border-color:transparent #fff;
        /* reduce the damage in FF3.0 */
        display:block;
        width:0;
      }

      blockquote {
          margin: 1em 0px;
      }



    </style>
  </head>
  <body>
    <textarea id="source">

class: bottom

# BOF5619 - Lean Beans (are made of this): Command pattern vs. MVC

Michael Bar-Sinai ([@michbarsinai](https://twitter.com/michbarsinai))  
http://www.iq.harvard.edu/people/michael-bar-sinai  
http://mbarsinai.com/blog

Philip Durbin ([@philipdurbin](https://twitter.com/philipdurbin))  
http://www.iq.harvard.edu/people/philip-durbin  
http://greptilian.com

.right[[![IQSS logo](images/iqss-logo.png)](http://www.iq.harvard.edu)]

---

class: bigfont

<!-- FIXME: title is too far right -->
# Agenda

1. Introduction
1. Motivation
1. A use case
1. Deep-dive
1. Come for air
1. Running code

---

# Introduction

What is a design pattern?

<img src="images/gof.png" width="300"/>
<img src="images/hfdp.jpg" width="300"/>

---

# Motivation

<!-- <blockquote class="rectangle-speech-border"> -->
<img src="images/in-command-now.jpg" width="600"/>
<blockquote class="example-obtuse">
  <p style="font-size:1.7em;">You are in command now, Admiral Piett.</p>
</blockquote>

---

class: bigfont

# A use case: Find the droids

<img src="images/look-sir-droids.jpg" width="400"/>

--

- look around for droids

--

- check identification

--

- big promotion

---
# Our first command: CheckIdCommand

<img src="images/not-the-droids.png" width="600"/>

```java
public class CheckIdCommand implements Command {
...
```

---

class: bigfont

# Definining the command pattern

- command
- receiver
- invoker
- client

--

An example from http://en.wikipedia.org/wiki/Command_pattern

---

.left-column[
  ## Four terms
  ### - command
]
.right-column[

# command

A command object has a receiver object and invokes a method of the receiver in a way that is specific to that receiver's class. 

```java
/* The Command interface */
public interface Command {
   void execute();
}
 
/* Command for turning on light - ConcreteCommand #1 */
public class FlipUpCommand implements Command {
   private Light theLight;
 
   public FlipUpCommand(Light light) {
      this.theLight = light;
   }
 
   public void execute(){
      theLight.turnOn();
   }
}
```

]

---

.left-column[
  ## Four terms
  ### - command
  ### - receiver
]
.right-column[

# receiver

The receiver may be called the target. It does the work.

```java
/* The Receiver class */
public class Light {
 
   public void turnOn() {
      System.out.println("The light is on");
   }
 
   public void turnOff() {
      System.out.println("The light is off");
   }
}
```

]

---

.left-column[
  ## Four terms
  ### - command
  ### - receiver
  ### - invoker
]
.right-column[

# invoker

The invoker invokes the command and optionally does bookkeeping about the command execution.

```java
/* The Invoker class */
public class Switch {
   private List<Command> history = new ArrayList<Command>();
 
   public void storeAndExecute(Command cmd) {
      this.history.add(cmd); // optional 
      cmd.execute();        
   }
}
```

]

---

.left-column[
  ## Four terms
  ### - command
  ### - receiver
  ### - invoker
  ### - client
]
.right-column[

# client

The client contains the decision making about which commands to execute at which points.

```java
/* The test class or client */
public class PressSwitch {
   public static void main(String[] args){
      Light lamp = new Light();
      Command switchUp = new FlipUpCommand(lamp);
      Command switchDown = new FlipDownCommand(lamp);
 
      Switch mySwitch = new Switch();
 
      switch(args[0]) {
         case "ON":
            mySwitch.storeAndExecute(switchUp);
         break;
         case "OFF":
            mySwitch.storeAndExecute(switchDown);
         break;
         default:
            System.out.println("ON or OFF?");
       }
   }
}
```

]

---

# Back on schedule

<blockquote class="example-obtuse">
  <p style="font-size:1.4em;">You may dispense with the pleasantries, Commander. I'm here to put you back on schedule.</p>
</blockquote>

<img src="images/schedule.jpg" width="600"/>

---

# More on the command pattern

- https://github.com/bethrobson/Head-First-Design-Patterns/tree/master/src/headfirst/designpatterns/command (Java 8!)
- http://gameprogrammingpatterns.com/command.html
- http://www.vincehuston.org/dp/command.html
  - http://www.vincehuston.org/dp/CommandDemosJava
- http://iqss.github.io/javaone2014-bof5619 (sample code from this talk)

    </textarea>
    <script src="http://gnab.github.io/remark/downloads/remark-latest.min.js" type="text/javascript">
    </script>
    <script type="text/javascript">
      var slideshow = remark.create();
    </script>
  </body>
</html>
